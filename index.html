<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="transparent" />
  <title>Kapitler — Spillelister</title>
  <!-- Typografi (print-inspirert) -->
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Inter:wght@300;400;600&family=Newsreader:ital,wght@0,300;1,300&display=swap" rel="stylesheet">
  <style>
    :root {
      /* ENDRET: basebakgrunn satt til ønsket farge */
      --paper:#729092; /* <- hovedbakgrunn */
      --ink:#111;
      --muted:#3D3A36;
      --muted-text: #2A2825; /* Mørkere for bedre kontrast */
      --maxw:1120px;
      --radius:10px;
      --shadow:0 12px 28px rgba(0,0,0,.12);
      --gap:26px;
      /* aksentpalett brukt i stripe og glimt */
      --acc-blue:#0073C6;
      --acc-red:#D93C3C;
      --acc-gold:#C9A66B;
      --acc-plum:#5B4A58;
      --acc-sky:#AEC6CF;
    }
    * { box-sizing:border-box; }
    html {
      --grain-opacity: 0.04;
      --vignette-strength: 0.1;

      background-color: var(--paper);
      background-image:
        /* Vignette: a simple, single radial gradient for a soft edge darkening */
        radial-gradient(ellipse at center, transparent 65%, rgba(0, 0, 0, var(--vignette-strength))),
        /* Grain: using an SVG with baked-in opacity */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="220" height="220"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.85" numOctaves="2"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.04"/></svg>');

      background-attachment: fixed;
      background-size: 100% 100%, auto;
    }

    body {
      margin: 0;
      background-color: transparent;
      color: var(--ink);
      font-family: Inter, sans-serif;
      line-height: 1.65;
      -webkit-font-smoothing: antialiased;
      position: relative;
      overflow-x: hidden;

      /* Animated glow layer, blended softly over the html background */
      background-image: linear-gradient(135deg,
        var(--acc-blue), var(--acc-red), var(--acc-gold),
        var(--acc-plum), var(--acc-sky), var(--acc-blue));
      background-size: 400% 400%;
      background-attachment: fixed;
      background-blend-mode: soft-light;
      background-position: 50% 50%;
      animation: stripeFlow 80s linear infinite;
    }

    /* Mobil og redusert bevegelse */
    @media (max-width: 768px), (hover: none), (pointer: coarse) {
      body {
        animation: none;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      body,
      .plate,
      .stripe {
        animation: none;
      }
    }

    .container {
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 48px 20px 24px;
      position: relative;
      z-index: 2;

      /* Legg til polstring for safe-areas (notch, home indicator) */
      padding-top: calc(48px + env(safe-area-inset-top, 0));
      padding-right: calc(20px + env(safe-area-inset-right, 0));
      padding-bottom: calc(24px + env(safe-area-inset-bottom, 0));
      padding-left: calc(20px + env(safe-area-inset-left, 0));
    }

    header.brev { padding-top:56px; text-align:center; position: relative; z-index: 2; }
    .brev h1 { font-family:"Archivo Black"; font-size:clamp(2rem,3.2vw,2.6rem); margin:0 0 12px; }
    .brev p { font-family:"Newsreader", serif; font-style:italic; color:var(--muted-text); max-width:70ch; margin:0 auto; }

    main {
      padding: 16px calc(20px + env(safe-area-inset-right, 0)) calc(72px + env(safe-area-inset-bottom, 0)) calc(20px + env(safe-area-inset-left, 0));
      position: relative;
      z-index: 2;
    }
    .grid { display:grid; gap:var(--gap); grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); max-width:var(--maxw); margin:0 auto; }

    /* Juster gap for mindre skjermer */
    @media (max-width: 768px) {
      :root {
        --gap: 16px;
      }
    }

    /* Kort med naturlig vind-bølge animasjon */
    .plate { display:block; border-radius:var(--radius); overflow:hidden; background:rgba(255,255,255,.55); border:1px solid rgba(0,0,0,.08); box-shadow:var(--shadow); text-decoration:none; color:inherit; position:relative; transform:translateZ(0); transition:box-shadow .4s ease; will-change:transform; animation: wind 14s cubic-bezier(.45,.05,.35,.95) infinite; }
    .plate:hover { box-shadow:0 16px 32px rgba(0,0,0,.16); }
    .plate:focus-visible {
      box-shadow: 0 10px 20px rgba(0,0,0,.14);
      outline: 2px solid var(--acc-blue);
      outline-offset: 4px;
      border-radius: var(--radius); /* Ensure outline follows border radius */
    }
    .plate:nth-child(2n) { animation-delay:2.5s; }
    .plate:nth-child(3n) { animation-delay:5s; }
    @keyframes wind { 0%{ transform:translateY(0) rotate(0deg);} 25%{ transform:translateY(-6px) rotate(-0.25deg);} 50%{ transform:translateY(3px) rotate(0.2deg);} 75%{ transform:translateY(-4px) rotate(-0.15deg);} 100%{ transform:translateY(0) rotate(0deg);} }

    /* Ytelsesforbedringer for rendering */
    header.container, main, footer {
      content-visibility: auto;
    }

    /* Stripe med rolig, sømløs fargedrift */
    .stripe { position:absolute; top:0; left:0; right:0; height:6px; background:linear-gradient(90deg,var(--acc-blue),var(--acc-red),var(--acc-gold),var(--acc-plum),var(--acc-sky),var(--acc-blue)); background-size:500% 100%; animation: stripeFlow 120s linear infinite; }
    @keyframes stripeFlow { 0%{background-position:0% 50%;} 100%{background-position:100% 50%;} }

    .cover { width:100%; aspect-ratio:1/1; object-fit:cover; display:block; }

    footer {
      text-align: center;
      font-size: 1rem;
      padding: 0 calc(20px + env(safe-area-inset-right, 0)) calc(64px + env(safe-area-inset-bottom, 0)) calc(20px + env(safe-area-inset-left, 0));
      position: relative;
      z-index: 2;
    }
    .footer-note { font-family:"Inter", sans-serif; font-size:0.95rem; color:var(--muted); margin-bottom:12px; }
    .quote { max-width:800px; margin:0 auto; font-family:"Newsreader", serif; font-style:italic; font-size:1.1rem; line-height:1.9; color:var(--muted); text-align:center; }
    .quote strong { font-family:"Archivo Black", sans-serif; font-style:normal; font-size:1.15rem; margin:0 4px; color:var(--ink); }

    /* Stil for feil- og tomtilstand-meldinger */
    .error-message, .empty-message {
      color: var(--muted-text);
      background: rgba(255,255,255,.5);
      padding: 24px;
      border-radius: var(--radius);
      text-align: center;
      grid-column: 1 / -1; /* Sørger for at meldingen spenner over hele gridet */
      font-family: "Inter", sans-serif;
      font-style: italic;
    }
  </style>
</head>
<body>
  <header class="brev container" aria-label="Brev fra Marcus til Athina">
    <h1>Kjære Athina</h1>
    <p>Jeg har laget dette lille stedet for oss, et sted hvor musikken kan samle seg, kapittel for kapittel. Når du åpner listene, håper jeg du kjenner at tankene mine er hos deg.</p>
  </header>

  <main>
    <section class="grid" id="grid" aria-label="Spillelister"></section>
  </main>

  <footer>
    <p class="footer-note">En liten hilsen fra meg, et sitat jeg satte pris på.</p>
    <p class="quote">
      <strong>If we're dating</strong>, I don't want to be your first priority. I shouldn't be. 
      I want your first priority to be you, your ambitions, your life, and your future. 
      <strong>Stay focused</strong>, I want the best for you. I want to be your motivation, your support, your help to grow. 
      <strong>I'm not gonna let you give up on yourself.</strong> I got you if you got me.
    </p>
  </footer>

  <script>
    async function loadPlaylists() {
      const grid = document.getElementById('grid');
      try {
        const res = await fetch('playlist.json', { cache: 'no-cache' });
        if (!res.ok) {
          throw new Error(`Nettverksrespons var ikke ok, status: ${res.status}`);
        }
        const data = await res.json();
        renderPlaylists(Array.isArray(data) ? data : []);
      } catch (e) {
        console.error('Feil ved lasting av spillelister:', e);
        grid.innerHTML = `<p class="error-message">Kunne ikke laste spillelistene. Sjekk nettverksforbindelsen og prøv igjen.</p>`;
      }
    }

    function renderPlaylists(list) {
      const grid = document.getElementById('grid');
      grid.innerHTML = ''; // Tøm gridet
      if (!list || list.length === 0) {
        grid.innerHTML = `<p class="empty-message">Fant ingen spillelister.</p>`;
        return;
      }
      list.forEach((pl) => {
        const card = document.createElement('a');
        card.className = 'plate';
        card.href = pl.url;
        card.target = '_blank';
        card.rel = 'noopener';
        card.setAttribute('aria-label', `${pl.title}: ${pl.subtitle}`);
        const stripe = document.createElement('span');
        stripe.className = 'stripe';
        const img = document.createElement('img');
        img.className = 'cover';
        img.src = pl.cover;
        img.alt = '';
        img.loading = 'lazy';
        img.decoding = 'async';
        card.append(stripe, img);
        grid.appendChild(card);
      });
    }
    document.addEventListener('DOMContentLoaded',loadPlaylists);
  </script>
</body>
</html>
